<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- Custom Styles -->
    <link href="assets/css/style.css" rel="stylesheet">    
    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>Restaurant Review</title>
  </head>
  <body class="my-account">

  <div class="container">
    <header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
      <a href="index.html" class="d-flex align-items-center col-md-3 mb-2 mb-md-0 text-dark text-decoration-none">
        Restaurant Reviews
      </a>

      <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
        <li><a href="index.html" class="nav-link px-2 link-dark">Home</a></li>
        <li><a href="top-restaurants.html" class="nav-link px-2 link-dark">Top Restaurants</a></li>
      </ul>

      <div class="col-md-3 text-end">
        <a id="header_login_link" href="login.html" type="button" class="btn btn-outline-primary me-2">Login</a>
        <a id="header_my_account_link" href="my-account.html" type="button" class="btn btn-outline-primary me-2 d-none">My Account</a>
        <a id="header_signup_link" type="button" class="btn btn-primary">Sign-up</a>
        <a id="header_admin_link" type="button" class="btn btn-primary d-none">Admin</a>
        <a id="header_logout_link" type="button" class="btn btn-primary d-none">Logout</a>
      </div>
    </header>
  </div>

  <div class="container">

    <div class="row">
      <div class="col-sm-2 account-sidebar">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="my-account.html">My Account</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="my-reviews.html">My Reviews</a>
          </li>
        </ul>
      </div>

      <div class="col-sm-10 account-details px-4">
        <div class="row account-detail-row mb-2">
          <h3 class="mb-5">Your Details</h3>
          <div class="col-6">
            <p><strong>Display Name</strong></p>
          </div>
          <div class="col-6">
            <p id="account_display_name"></p>
          </div>
        </div>
        <div class="row account-detail-row mb-2">
          <div class="col-6">
            <p><strong>Email</strong></p>
          </div>
          <div class="col-6">
            <p id="account_email"></p>
          </div>
        </div>
        <div class="row account-detail-row mb-2">
          <div class="col-6">
            <p><strong>User ID</strong></p>
          </div>
          <div class="col-6">
            <p id="user_id"></p>
          </div>
        </div>

        <div id="account_loader">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <span class="loading-text">Loading....</span>            
        </div>
        
      </div>
    </div>
  </div>

  
  <div class="container">
    <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
      <div class="col-md-4 d-flex align-items-center">
        <a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
          <svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
        </a>
        <span class="text-muted">Â© 2022 Restaurant Review System</span>
      </div>
    </footer>
  </div>  

    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <!--
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
      import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries
    </script>
-->
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>
    <!-- TODO: Add SDKs for Firebase products that you want to use
    https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.0.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-analytics.js"></script>

    <script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />     

    <!--Custom utility functions for the website-->
    <script src="assets/js/custom.js"></script>

    <script>
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBhqI5gPXI7UNbUiswgvTRC3wnD6SELM9c",
        authDomain: "reviewsystem-b2602.firebaseapp.com",
        projectId: "reviewsystem-b2602",
        storageBucket: "reviewsystem-b2602.appspot.com",
        messagingSenderId: "639222450302",
        appId: "1:639222450302:web:7dcc07b601af8bcc63f02f"
      };
    
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      firebase.analytics();

      var firestore     = firebase.firestore(); //Reference to database
      var ui            = new firebaseui.auth.AuthUI(firebase.auth());

      var uiConfig = {
        callbacks: {
          signInSuccessWithAuthResult: function(authResult, redirectUrl) {
            // User successfully signed in.
            // Return type determines whether we continue the redirect automatically
            // or whether we leave that to developer to handle.
            checkUserInDB(authResult.user)
            return false;
          },
          uiShown: function() {
            // The widget is rendered.
            // Hide the loader.
            document.getElementById('loader').style.display = 'none';
          }
        },
        // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
        signInFlow: 'popup',
        signInSuccessUrl: 'index.html',
        signInOptions: [
          {
            // Leave the lines as is for the providers you want to offer your users.
            provider: firebase.auth.EmailAuthProvider.PROVIDER_ID,
            requireDisplayName: false,
          }
        ],
        // Terms of service url.
        tosUrl: '<your-tos-url>',
        // Privacy policy url.
        privacyPolicyUrl: '<your-privacy-policy-url>'
      };      

//The only functions needed on the page to show user details      
firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    showUserDetails(firebase.auth().currentUser.uid);
    updateLinksInHeader();    
  } else {
    // No user is signed in.
  }
});

      // document.querySelector("#add_resturant_button").addEventListener("click",function(e){
      //       e.preventDefault();
      //       //reset the alert and success on button click
      //       $("#restaurant-alert").addClass("d-none");
      //       $("#restaurant-success").addClass("d-none");

      //       let fields = [];
            
      //       const restaurant_name     = document.querySelector("#restaurant_name").value;
      //       const restaurant_address  = document.querySelector("#restaurant_address").value;
      //       const type_service        = document.querySelector("#type_service").value;
      //       const type_food           = document.querySelector("#type_food").value;
      //       const occasion            = document.querySelector("#occasion").value;
      //       const dining_option       = $('#dining_option').val();
      //       const average_expense     = document.querySelector("#average_expense").value;
      //       const qualtiy_food        = document.querySelector("#qualtiy_food").value;
      //       const ambiance            = document.querySelector("#ambiance").value;
      //       const quality_service     = document.querySelector("#quality_service").value;
      //       const cleanliness         = document.querySelector("#cleanliness").value;
      //       const speed_service       = document.querySelector("#speed_service").value;
      //       const value_money         = document.querySelector("#value_money").value;
      //       const allergy_information = document.querySelector("#allergy_information").value;

      //       const FieldsEmpty = areFieldsEmpty(restaurant_name,restaurant_address, type_service,type_food,occasion,dining_option,average_expense,qualtiy_food,ambiance,quality_service,cleanliness,speed_service,value_money,allergy_information);

      //       if(FieldsEmpty){
      //         $("#restaurant-alert").removeClass("d-none");
      //       }
      //       else{
              
      //         $("#restaurant-alert").addClass("d-none");

      //         firestore.collection("Restaurant").add({
      //             name:                 restaurant_name,
      //             address:              restaurant_address,
      //             type_service:         type_service,
      //             type_food:            type_food,
      //             occasion:             occasion,    
      //             dining:               dining_option,    //should be an array
      //             average_expense:      average_expense,    
      //             quality_food:         qualtiy_food,    
      //             ambiance:             ambiance,    
      //             quality_service:      quality_service,    
      //             cleanliness:          cleanliness,    
      //             speed_service:        speed_service,    
      //             value_money:          value_money,
      //             allergy_information:  allergy_information    
      //         })
      //         .then((docRef) => {
      //             console.log("Document written with ID: ", docRef.id);
      //             $("#restaurant-success").removeClass("d-none");
      //         })
      //         .catch((error) => {
      //             console.error("Error adding document: ", error);
      //         });
      //       }
      // });

/*      
firestore.collection("Users").add({
    first: "Ada",
    last: "Lovelace",
    born: 1815
})
.then((docRef) => {
    console.log("Document written with ID: ", docRef.id);
})
.catch((error) => {
    console.error("Error adding document: ", error);
});
*/

// firestore.collection("Restaurant").add({
//     name:                 "KFC",
//     address:                 "KFC",
//     type_service:         "Fast Food",
//     type_food:            "American",
//     occasion:             "Family Meal",    
//     dining:               "lunch",    //should be an array
//     average_expense:      7,    
//     qualtiy_food:         "Good",    
//     ambiance:             "Cool",    
//     quality_service:      "Good",    
//     cleanliness:          "Good",    
//     speed_service:        "Fast",    
//     value_money:          "Yes",
//     allergy_information:  "Yes"    
// })
// .then((docRef) => {
//     console.log("Document written with ID: ", docRef.id);
// })
// .catch((error) => {
//     console.error("Error adding document: ", error);
// });

// firestore.collection("Reviews").add({
//     userID:               "cZGFYworR7fM2ofWMwegFm7ZVJV2",
//     restuarant_ID:        "XDYXK2T4nzlEkeI2Kb0G",
//     review_text:          "Good Meal! I Like! Yum Yum",
//     rating:               4
// })
// .then((docRef) => {
//     console.log("Document written with ID: ", docRef.id);
// })
// .catch((error) => {
//     console.error("Error adding document: ", error);
// });




//------------------------The thing that I need to check often
// firestore.collection("Users").get().then((querySnapshot) => {
//     querySnapshot.forEach((doc) => {
//         console.log(`${doc.id} => ${doc.data()}`);
//     });
// });

    </script>
    

  </body>
</html>